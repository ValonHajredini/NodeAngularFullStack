<div class="tools-list-container">
  <!-- Header -->
  <div class="tools-list-header">
    <h2>Registered Tools</h2>
    <p class="subtitle">Browse and manage your registered tools</p>
  </div>

  <!-- Search & Filters Section -->
  <div class="filters-section" [formGroup]="filterForm">
    <div class="filters-row">
      <!-- Search Input -->
      <div class="search-input-wrapper">
        <span class="p-input-icon-left w-full">
          <i class="pi pi-search"></i>
          <input
            type="text"
            pInputText
            formControlName="search"
            placeholder="Search tools by name or description..."
            aria-label="Search tools"
            class="w-full"
            [class.loading]="searching()"
          />
          <i
            *ngIf="filterForm.get('search')?.value"
            class="pi pi-times clear-icon"
            (click)="filterForm.patchValue({ search: '' })"
            (keydown.enter)="filterForm.patchValue({ search: '' })"
            (keydown.space)="filterForm.patchValue({ search: '' })"
            tabindex="0"
            role="button"
            aria-label="Clear search"
          ></i>
        </span>
        <small *ngIf="searching()" class="searching-text">
          <i class="pi pi-spin pi-spinner"></i> Searching...
        </small>
      </div>

      <!-- Status Filter -->
      <div class="filter-dropdown">
        <label for="status-filter">Status</label>
        <p-select
          id="status-filter"
          formControlName="status"
          [options]="statusOptions"
          optionLabel="label"
          optionValue="value"
          placeholder="All Statuses"
          [style]="{ width: '200px' }"
          aria-label="Filter by status"
        ></p-select>
      </div>

      <!-- Clear Filters Button -->
      <p-button
        *ngIf="hasActiveFilters()"
        label="Clear Filters"
        icon="pi pi-filter-slash"
        severity="secondary"
        (onClick)="clearFilters()"
        [outlined]="true"
        class="clear-filters-btn"
        aria-label="Clear all filters"
      ></p-button>
    </div>

    <!-- Result Count -->
    <div class="result-count" aria-live="polite" aria-atomic="true">
      <span *ngIf="!loading() && !error()">
        Showing <strong>{{ resultCount() }}</strong> of
        <strong>{{ totalCount() }}</strong>
        {{ totalCount() === 1 ? 'tool' : 'tools' }}
      </span>
    </div>
  </div>

  <!-- Loading State -->
  <ng-container *ngIf="loading()">
    <div class="loading-message">
      <i class="pi pi-spin pi-spinner"></i>
      <span>Loading tools...</span>
    </div>
    <div class="tools-grid tools-grid-skeleton">
      <app-tool-card *ngFor="let i of skeletonCount" [loading]="true"></app-tool-card>
    </div>
  </ng-container>

  <!-- Error State -->
  <ng-container *ngIf="error() && !loading()">
    <div class="error-state">
      <i class="pi pi-exclamation-triangle error-icon"></i>
      <h3>Failed to Load Tools</h3>
      <p class="error-message">{{ error() }}</p>
      <p-button
        label="Try Again"
        icon="pi pi-refresh"
        (onClick)="refreshTools()"
        severity="secondary"
      ></p-button>
    </div>
  </ng-container>

  <!-- No Results (with active filters) -->
  <ng-container
    *ngIf="!loading() && !error() && filteredTools().length === 0 && hasActiveFilters()"
  >
    <div class="no-results-state">
      <i class="pi pi-filter-slash no-results-icon"></i>
      <h3>No Tools Match Your Filters</h3>
      <p class="no-results-message">Try adjusting your search or filter criteria</p>
      <div class="active-filters">
        <span *ngIf="filterForm.get('search')?.value" class="filter-chip">
          Search: "{{ filterForm.get('search')?.value }}"
        </span>
        <span *ngIf="filterForm.get('status')?.value" class="filter-chip">
          Status: {{ filterForm.get('status')?.value }}
        </span>
      </div>
      <p-button
        label="Clear Filters"
        icon="pi pi-filter-slash"
        (onClick)="clearFilters()"
        severity="primary"
      ></p-button>
    </div>
  </ng-container>

  <!-- Empty State (no tools at all) -->
  <ng-container *ngIf="!loading() && !error() && tools().length === 0 && !hasActiveFilters()">
    <div class="empty-state">
      <i class="pi pi-inbox empty-icon"></i>
      <h3>No Tools Found</h3>
      <p class="empty-message">Get started by registering your first tool</p>
      <p-button
        label="Register New Tool"
        icon="pi pi-plus"
        severity="primary"
        [routerLink]="['/tools/create']"
      ></p-button>
    </div>
  </ng-container>

  <!-- Tools Grid -->
  <ng-container *ngIf="!loading() && !error() && filteredTools().length > 0">
    <div class="tools-grid">
      <app-tool-card
        *ngFor="let tool of filteredTools()"
        [tool]="tool"
        [interactive]="true"
        (toolClick)="onToolClick($event)"
      ></app-tool-card>
    </div>
  </ng-container>
</div>
