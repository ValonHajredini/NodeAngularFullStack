<div class="svg-symbol-library-panel">
  <!-- Search Filter -->
  @if (symbolLibrary.symbols().length > 0) {
    <div class="mb-3 search-wrapper">
      <i class="pi pi-search search-icon"></i>
      <input
        type="text"
        pInputText
        [(ngModel)]="searchTerm"
        (ngModelChange)="searchTerm.set($event)"
        placeholder="Filter symbols..."
        class="w-full search-input"
      />
    </div>
  }

  <!-- Empty State -->
  @if (symbolLibrary.symbols().length === 0) {
    <div class="text-center py-6">
      <i class="pi pi-inbox text-3xl text-gray-300 mb-2 block"></i>
      <p class="text-sm text-gray-500">No symbols yet</p>
      <p class="text-xs text-gray-400">Import SVG files above</p>
    </div>
  }

  <!-- No Results State -->
  @if (symbolLibrary.symbols().length > 0 && filteredSymbols().length === 0) {
    <div class="text-center py-6">
      <i class="pi pi-search text-3xl text-gray-300 mb-2 block"></i>
      <p class="text-sm text-gray-500">No symbols found</p>
      <p class="text-xs text-gray-400">Try a different search term</p>
    </div>
  }

  <!-- Symbols Grid with Scroll -->
  @if (symbolLibrary.symbols().length > 0 && filteredSymbols().length > 0) {
    <!-- Scrollable Grid Area - Only scrolls the grid -->
    <div class="symbols-scroll-area mb-3">
      <div class="grid grid-cols-4 gap-2">
        @for (symbol of filteredSymbols(); track symbol.id) {
          <div
            class="symbol-card border-2 rounded p-1.5 cursor-pointer transition-all hover:shadow-sm relative"
            [class.border-blue-500]="symbolLibrary.selectedSymbolId() === symbol.id"
            [class.bg-blue-50]="symbolLibrary.selectedSymbolId() === symbol.id"
            [class.border-gray-200]="symbolLibrary.selectedSymbolId() !== symbol.id"
            (click)="onSelectSymbol(symbol)"
          >
            <!-- Actions - Top Right -->
            <div class="symbol-actions absolute top-0.5 right-0.5 flex gap-0.5 z-10">
              <button
                pButton
                type="button"
                icon="pi pi-pencil"
                severity="secondary"
                size="small"
                [text]="true"
                [rounded]="true"
                (click)="onRenameSymbol($event, symbol)"
                pTooltip="Rename"
                tooltipPosition="top"
                class="!w-5 !h-5 !text-[10px]"
              ></button>
              <button
                pButton
                type="button"
                icon="pi pi-trash"
                severity="danger"
                size="small"
                [text]="true"
                [rounded]="true"
                (click)="onDeleteSymbol($event, symbol)"
                pTooltip="Delete"
                tooltipPosition="top"
                class="!w-5 !h-5 !text-[10px]"
              ></button>
            </div>

            <!-- Preview -->
            <div
              class="symbol-preview bg-white rounded border border-gray-200 p-1 mb-1 flex items-center justify-center h-12"
            >
              <div [innerHTML]="getSymbolPreview(symbol)" class="max-w-full max-h-full"></div>
            </div>

            <!-- Info -->
            <div class="symbol-info">
              <p class="text-[10px] font-semibold text-gray-800 truncate" [title]="symbol.name">
                {{ symbol.name }}
              </p>
              <p class="text-[9px] text-gray-500">{{ symbol.width }}Ã—{{ symbol.height }}</p>
            </div>
          </div>
        }
      </div>
    </div>

    <!-- Actions -->
    <div class="flex gap-2">
      <button
        pButton
        type="button"
        label="Clear All"
        icon="pi pi-trash"
        severity="danger"
        [outlined]="true"
        (click)="onClearLibrary()"
        class="flex-1"
        size="small"
      ></button>
    </div>
  }

  <!-- Selected Symbol Info -->
  @if (symbolLibrary.selectedSymbolId()) {
    <div class="mt-3 p-2 bg-blue-50 border border-blue-200 rounded">
      <div class="flex items-center gap-2">
        <i class="pi pi-check-circle text-blue-600 text-sm"></i>
        <div class="text-xs text-blue-900">
          <strong>{{ getSelectedSymbol()?.name }}</strong> - Click canvas to place
        </div>
      </div>
    </div>
  }
</div>
