# Environment Variables Documentation\n\nComprehensive guide to all environment variables supported by the NodeAngularFullStack application, including multi-tenancy configuration options.\n\n## Table of Contents\n\n1. [Quick Start](#quick-start)\n2. [Core Application Settings](#core-application-settings)\n3. [Database Configuration](#database-configuration)\n4. [Authentication & Security](#authentication--security)\n5. [Multi-Tenancy Configuration](#multi-tenancy-configuration)\n6. [External Services](#external-services)\n7. [Monitoring & Logging](#monitoring--logging)\n8. [Deployment Examples](#deployment-examples)\n9. [Troubleshooting](#troubleshooting)\n\n---\n\n## Quick Start\n\n### Single-Tenant Mode (Default)\n```bash\n# Copy the example file\ncp .env.example .env\n\n# Edit with your values\nnano .env\n\n# Required minimum variables:\nJWT_SECRET=your-secure-secret-at-least-32-characters\nJWT_REFRESH_SECRET=your-refresh-secret-at-least-32-characters\nDB_USER=your_database_user\nDB_PASSWORD=your_database_password\nSENDGRID_API_KEY=your_sendgrid_api_key\nEMAIL_FROM=your-email@domain.com\nAPI_KEY=your-api-key\n```\n\n### Multi-Tenant Mode\n```bash\n# Enable multi-tenancy\nENABLE_MULTI_TENANCY=true\nTENANT_ISOLATION_LEVEL=row\nTENANT_RLS_ENABLED=true\nTENANT_CROSS_ACCESS_PREVENTION=true\nTENANT_AUDIT_LOGGING=true\nTENANT_TOKEN_ISOLATION=true\n```\n\n---\n\n## Core Application Settings\n\n### NODE_ENV\n- **Type**: `string`\n- **Valid Values**: `development`, `production`, `test`\n- **Default**: `development`\n- **Description**: Application environment mode\n- **Example**: `NODE_ENV=production`\n\n### PORT\n- **Type**: `number`\n- **Range**: `1-65535`\n- **Default**: `3000`\n- **Description**: Port on which the API server will listen\n- **Example**: `PORT=8080`\n\n### FRONTEND_URL\n- **Type**: `string` (URL)\n- **Default**: `http://localhost:4200`\n- **Description**: URL of the frontend application for CORS and redirects\n- **Example**: `FRONTEND_URL=https://myapp.com`\n- **Production Note**: Must use HTTPS in production\n\n---\n\n## Database Configuration\n\n### DB_HOST\n- **Type**: `string` (hostname)\n- **Required**: ✅\n- **Description**: PostgreSQL database host\n- **Example**: `DB_HOST=localhost` or `DB_HOST=db.example.com`\n\n### DB_PORT\n- **Type**: `number`\n- **Default**: `5432`\n- **Description**: PostgreSQL database port\n- **Example**: `DB_PORT=5432`\n\n### DB_NAME\n- **Type**: `string`\n- **Required**: ✅\n- **Description**: PostgreSQL database name\n- **Example**: `DB_NAME=nodeangularfullstack`\n\n### DB_USER\n- **Type**: `string`\n- **Required**: ✅\n- **Description**: PostgreSQL database username\n- **Example**: `DB_USER=dbuser`\n\n### DB_PASSWORD\n- **Type**: `string`\n- **Required**: ✅\n- **Description**: PostgreSQL database password\n- **Example**: `DB_PASSWORD=securepassword123`\n- **Security Note**: Use strong passwords in production\n\n### DB_SSL\n- **Type**: `boolean`\n- **Default**: `false`\n- **Description**: Enable SSL connection to database\n- **Example**: `DB_SSL=true`\n- **Production Note**: Recommended for production environments\n\n---\n\n## Authentication & Security\n\n### JWT_SECRET\n- **Type**: `string`\n- **Required**: ✅\n- **Min Length**: 32 characters (64+ recommended for production)\n- **Description**: Secret key for signing JWT access tokens\n- **Example**: `JWT_SECRET=your-super-secure-secret-key-at-least-32-chars`\n- **Security Note**: **MUST** be changed from default in production\n\n### JWT_REFRESH_SECRET\n- **Type**: `string`\n- **Required**: ✅\n- **Min Length**: 32 characters (64+ recommended for production)\n- **Description**: Secret key for signing JWT refresh tokens\n- **Example**: `JWT_REFRESH_SECRET=your-refresh-secret-different-from-access`\n- **Security Note**: Should be different from JWT_SECRET\n\n### JWT_EXPIRES_IN\n- **Type**: `number` (seconds)\n- **Default**: `3600` (1 hour)\n- **Description**: JWT access token expiration time\n- **Example**: `JWT_EXPIRES_IN=1800` (30 minutes)\n- **Production Note**: Shorter expiration recommended for production\n\n### JWT_REFRESH_EXPIRES_IN\n- **Type**: `number` (seconds)\n- **Default**: `604800` (7 days)\n- **Description**: JWT refresh token expiration time\n- **Example**: `JWT_REFRESH_EXPIRES_IN=2592000` (30 days)\n\n---\n\n## Multi-Tenancy Configuration\n\n### ENABLE_MULTI_TENANCY\n- **Type**: `boolean`\n- **Default**: `false`\n- **Description**: Enable or disable multi-tenancy features\n- **Example**: `ENABLE_MULTI_TENANCY=true`\n- **Impact**: Affects database queries, authentication, and API behavior\n\n### DEFAULT_TENANT_ID\n- **Type**: `string`\n- **Default**: `default`\n- **Description**: Default tenant identifier for single-tenant mode\n- **Example**: `DEFAULT_TENANT_ID=my-company`\n- **Usage**: Used when multi-tenancy is disabled\n\n### TENANT_ISOLATION_LEVEL\n- **Type**: `string`\n- **Valid Values**: `row`, `schema`, `database`\n- **Default**: `row`\n- **Description**: Level of tenant data isolation\n- **Examples**:\n  - `TENANT_ISOLATION_LEVEL=row` - Row-level isolation (shared tables)\n  - `TENANT_ISOLATION_LEVEL=schema` - Schema-level isolation (separate schemas)\n  - `TENANT_ISOLATION_LEVEL=database` - Database-level isolation (separate databases)\n\n### TENANT_RLS_ENABLED\n- **Type**: `boolean`\n- **Default**: `true` (when multi-tenancy enabled)\n- **Description**: Enable PostgreSQL Row-Level Security for tenant isolation\n- **Example**: `TENANT_RLS_ENABLED=true`\n- **Requirements**: Required for row-level isolation security\n\n### TENANT_CROSS_ACCESS_PREVENTION\n- **Type**: `boolean`\n- **Default**: `true` (when multi-tenancy enabled)\n- **Description**: Prevent cross-tenant data access at application level\n- **Example**: `TENANT_CROSS_ACCESS_PREVENTION=true`\n- **Recommendation**: Keep enabled for security\n\n### TENANT_AUDIT_LOGGING\n- **Type**: `boolean`\n- **Default**: `true` (when multi-tenancy enabled)\n- **Description**: Enable tenant-specific audit logging\n- **Example**: `TENANT_AUDIT_LOGGING=true`\n- **Benefits**: Compliance and security monitoring\n\n### TENANT_TOKEN_ISOLATION\n- **Type**: `boolean`\n- **Default**: `true` (when multi-tenancy enabled)\n- **Description**: Include tenant context in JWT tokens\n- **Example**: `TENANT_TOKEN_ISOLATION=true`\n- **Benefits**: Prevents token reuse across tenants\n\n### TENANT_DATA_ENCRYPTION\n- **Type**: `boolean`\n- **Default**: `false`\n- **Description**: Enable encryption of tenant-specific data\n- **Example**: `TENANT_DATA_ENCRYPTION=true`\n- **Performance Note**: May impact performance, recommended for sensitive data\n\n### TENANT_REQUIRE_VERIFICATION\n- **Type**: `boolean`\n- **Default**: `true`\n- **Description**: Require email verification for tenant users\n- **Example**: `TENANT_REQUIRE_VERIFICATION=true`\n\n### TENANT_DEFAULT_PLAN\n- **Type**: `string`\n- **Valid Values**: `free`, `starter`, `professional`, `enterprise`\n- **Default**: `free`\n- **Description**: Default subscription plan for new tenants\n- **Example**: `TENANT_DEFAULT_PLAN=starter`\n\n### TENANT_MAX_USERS_DEFAULT\n- **Type**: `number`\n- **Default**: `5`\n- **Range**: `1-10000`\n- **Description**: Default maximum users per tenant\n- **Example**: `TENANT_MAX_USERS_DEFAULT=10`\n\n### TENANT_FEATURES_DEFAULT\n- **Type**: `string` (JSON object)\n- **Default**: `{}`\n- **Description**: Default feature flags for new tenants\n- **Example**: `TENANT_FEATURES_DEFAULT={\"api_access\":true,\"file_storage\":true}`\n- **Format**: Valid JSON object with boolean values\n\n---\n\n## External Services\n\n### Redis Configuration\n\n#### REDIS_HOST\n- **Type**: `string`\n- **Default**: `localhost`\n- **Description**: Redis server hostname\n- **Example**: `REDIS_HOST=redis.example.com`\n\n#### REDIS_PORT\n- **Type**: `number`\n- **Default**: `6379`\n- **Description**: Redis server port\n- **Example**: `REDIS_PORT=6379`\n\n#### REDIS_PASSWORD\n- **Type**: `string`\n- **Optional**: Yes\n- **Description**: Redis authentication password\n- **Example**: `REDIS_PASSWORD=redis_password`\n\n#### REDIS_DB\n- **Type**: `number`\n- **Default**: `0`\n- **Range**: `0-15`\n- **Description**: Redis database number\n- **Example**: `REDIS_DB=1`\n\n### File Storage (DigitalOcean Spaces)\n\n#### DO_SPACES_ENDPOINT\n- **Type**: `string` (URL)\n- **Required**: ✅\n- **Description**: DigitalOcean Spaces endpoint URL\n- **Example**: `DO_SPACES_ENDPOINT=https://nyc3.digitaloceanspaces.com`\n\n#### DO_SPACES_KEY\n- **Type**: `string`\n- **Required**: ✅\n- **Description**: DigitalOcean Spaces access key\n- **Example**: `DO_SPACES_KEY=your_spaces_access_key`\n\n#### DO_SPACES_SECRET\n- **Type**: `string`\n- **Required**: ✅\n- **Description**: DigitalOcean Spaces secret key\n- **Example**: `DO_SPACES_SECRET=your_spaces_secret_key`\n\n#### DO_SPACES_BUCKET\n- **Type**: `string`\n- **Required**: ✅\n- **Description**: DigitalOcean Spaces bucket name\n- **Example**: `DO_SPACES_BUCKET=my-app-files`\n\n#### DO_SPACES_REGION\n- **Type**: `string`\n- **Required**: ✅\n- **Description**: DigitalOcean Spaces region\n- **Example**: `DO_SPACES_REGION=nyc3`\n\n### Email Service (SendGrid)\n\n#### SENDGRID_API_KEY\n- **Type**: `string`\n- **Required**: ✅\n- **Description**: SendGrid API key for email sending\n- **Example**: `SENDGRID_API_KEY=SG.your_sendgrid_api_key`\n\n#### EMAIL_FROM\n- **Type**: `string` (email)\n- **Required**: ✅\n- **Description**: Default sender email address\n- **Example**: `EMAIL_FROM=noreply@myapp.com`\n\n#### EMAIL_FROM_NAME\n- **Type**: `string`\n- **Default**: `NodeAngularFullStack`\n- **Description**: Default sender name\n- **Example**: `EMAIL_FROM_NAME=My Application`\n\n---\n\n## Monitoring & Logging\n\n### SENTRY_DSN\n- **Type**: `string` (URL)\n- **Optional**: Yes\n- **Description**: Sentry DSN for error tracking\n- **Example**: `SENTRY_DSN=https://your-dsn@sentry.io/project-id`\n- **Recommendation**: Highly recommended for production\n\n### LOGTAIL_TOKEN\n- **Type**: `string`\n- **Optional**: Yes\n- **Description**: Logtail token for log aggregation\n- **Example**: `LOGTAIL_TOKEN=your_logtail_token`\n\n---\n\n## Rate Limiting & Security\n\n### RATE_LIMIT_WINDOW_MS\n- **Type**: `number` (milliseconds)\n- **Default**: `900000` (15 minutes)\n- **Description**: Rate limiting time window\n- **Example**: `RATE_LIMIT_WINDOW_MS=600000` (10 minutes)\n\n### RATE_LIMIT_MAX_REQUESTS\n- **Type**: `number`\n- **Default**: `100`\n- **Description**: Maximum requests per time window\n- **Example**: `RATE_LIMIT_MAX_REQUESTS=50`\n- **Development**: Can be set higher for development (e.g., 1000)\n\n### CORS_ORIGINS\n- **Type**: `string` (comma-separated URLs)\n- **Default**: `http://localhost:4200,http://localhost:3000`\n- **Description**: Allowed CORS origins\n- **Example**: `CORS_ORIGINS=https://myapp.com,https://www.myapp.com`\n\n### API_KEY\n- **Type**: `string`\n- **Required**: ✅\n- **Description**: API key for external service integrations\n- **Example**: `API_KEY=your_api_key_for_external_services`\n\n---\n\n## pgWeb Database Management\n\n### PGWEB_AUTH_USER\n- **Type**: `string`\n- **Default**: `admin`\n- **Description**: Username for pgWeb interface\n- **Example**: `PGWEB_AUTH_USER=dbadmin`\n\n### PGWEB_AUTH_PASS\n- **Type**: `string`\n- **Required**: ✅\n- **Min Length**: 8 characters\n- **Description**: Password for pgWeb interface\n- **Example**: `PGWEB_AUTH_PASS=secure_pgweb_password`\n- **Security Note**: **MUST** be changed from default in production\n\n### PGWEB_READ_ONLY\n- **Type**: `boolean`\n- **Default**: `false`\n- **Description**: Enable read-only mode for pgWeb\n- **Example**: `PGWEB_READ_ONLY=true`\n- **Production Note**: Recommended for production environments\n\n### PGWEB_SESSIONS\n- **Type**: `boolean`\n- **Default**: `true`\n- **Description**: Enable session management in pgWeb\n- **Example**: `PGWEB_SESSIONS=true`\n\n### PGWEB_CORS_ORIGIN\n- **Type**: `string` (URL)\n- **Default**: `http://localhost:4200`\n- **Description**: Allowed CORS origin for pgWeb\n- **Example**: `PGWEB_CORS_ORIGIN=https://admin.myapp.com`\n\n### PGWEB_DATABASE_URL\n- **Type**: `string` (URL)\n- **Required**: ✅\n- **Description**: Database connection URL for pgWeb\n- **Example**: `PGWEB_DATABASE_URL=postgresql://user:pass@host:5432/db?sslmode=require`\n\n---\n\n## Deployment Examples\n\n### Development Environment\n\n```bash\n# .env.development\nNODE_ENV=development\nPORT=3000\nFRONTEND_URL=http://localhost:4200\n\n# Database\nDB_HOST=localhost\nDB_PORT=5432\nDB_NAME=nodeangularfullstack_dev\nDB_USER=devuser\nDB_PASSWORD=devpassword\nDB_SSL=false\n\n# Single-tenant mode (simplified)\nENABLE_MULTI_TENANCY=false\nDEFAULT_TENANT_ID=development\nTENANT_RLS_ENABLED=false\nTENANT_AUDIT_LOGGING=false\nTENANT_TOKEN_ISOLATION=false\n\n# Development-friendly settings\nJWT_EXPIRES_IN=7200\nRATE_LIMIT_MAX_REQUESTS=1000\n```\n\n### Staging Environment\n\n```bash\n# .env.staging\nNODE_ENV=staging\nPORT=3000\nFRONTEND_URL=https://staging.myapp.com\n\n# Database\nDB_HOST=staging-db.myapp.com\nDB_PORT=5432\nDB_NAME=nodeangularfullstack_staging\nDB_SSL=true\n\n# Multi-tenancy enabled\nENABLE_MULTI_TENANCY=true\nTENANT_ISOLATION_LEVEL=row\nTENANT_RLS_ENABLED=true\nTENANT_CROSS_ACCESS_PREVENTION=true\nTENANT_AUDIT_LOGGING=true\nTENANT_TOKEN_ISOLATION=true\n\n# Monitoring\nSENTRY_DSN=https://staging-dsn@sentry.io/project\n```\n\n### Production Environment\n\n```bash\n# .env.production\nNODE_ENV=production\nPORT=3000\nFRONTEND_URL=https://myapp.com\n\n# Database (secure)\nDB_HOST=prod-db.myapp.com\nDB_PORT=5432\nDB_NAME=nodeangularfullstack_prod\nDB_SSL=true\n\n# Multi-tenancy (full security)\nENABLE_MULTI_TENANCY=true\nTENANT_ISOLATION_LEVEL=row\nTENANT_RLS_ENABLED=true\nTENANT_CROSS_ACCESS_PREVENTION=true\nTENANT_AUDIT_LOGGING=true\nTENANT_TOKEN_ISOLATION=true\nTENANT_DATA_ENCRYPTION=true\nTENANT_REQUIRE_VERIFICATION=true\n\n# Security (production)\nJWT_EXPIRES_IN=1800\nRATE_LIMIT_MAX_REQUESTS=100\nPGWEB_READ_ONLY=true\n\n# Monitoring (required)\nSENTRY_DSN=https://prod-dsn@sentry.io/project\nLOGTAIL_TOKEN=prod_logtail_token\n```\n\n---\n\n## Troubleshooting\n\n### Common Configuration Errors\n\n#### JWT Secret Too Short\n```\nError: JWT_SECRET must be at least 32 characters long for security\n```\n**Solution**: Use a longer, more secure secret\n```bash\nJWT_SECRET=\"your-super-secure-secret-key-that-is-at-least-32-characters-long\"\n```\n\n#### Multi-tenancy Configuration Conflict\n```\nError: Token isolation requires multi-tenancy to be enabled\n```\n**Solution**: Either enable multi-tenancy or disable token isolation\n```bash\n# Option 1: Enable multi-tenancy\nENABLE_MULTI_TENANCY=true\n\n# Option 2: Disable token isolation\nTENANT_TOKEN_ISOLATION=false\n```\n\n#### Database Connection Failed\n```\nError: Database connection failed\n```\n**Solution**: Check database configuration\n```bash\n# Verify these settings\nDB_HOST=correct_hostname\nDB_PORT=5432\nDB_NAME=existing_database_name\nDB_USER=valid_username\nDB_PASSWORD=correct_password\n```\n\n#### Invalid JSON in TENANT_FEATURES_DEFAULT\n```\nError: Invalid TENANT_FEATURES_DEFAULT JSON\n```\n**Solution**: Ensure valid JSON format\n```bash\n# Correct format\nTENANT_FEATURES_DEFAULT='{\"api_access\":true,\"file_storage\":false}'\n\n# Invalid format (missing quotes)\nTENANT_FEATURES_DEFAULT='{api_access:true,file_storage:false}'\n```\n\n### Configuration Validation\n\nThe application performs automatic validation on startup. Check the console output for:\n\n- ✅ Configuration validation passed\n- ⚠️ Configuration warnings (non-critical)\n- ❌ Configuration errors (critical, will prevent startup)\n\n### Environment-Specific Issues\n\n#### Development\n- Use `.env.development` for consistent development settings\n- Set `TENANT_RLS_ENABLED=false` for simpler development\n- Increase `RATE_LIMIT_MAX_REQUESTS` for development testing\n\n#### Production\n- Always use HTTPS for `FRONTEND_URL`\n- Enable `DB_SSL=true`\n- Set `PGWEB_READ_ONLY=true`\n- Configure monitoring with `SENTRY_DSN`\n- Use strong passwords and secrets\n\n### Getting Help\n\nIf you encounter configuration issues:\n\n1. Check the application startup logs for specific error messages\n2. Verify environment variables with the validation schemas\n3. Review the deployment examples for your target environment\n4. Ensure all required variables are set for your deployment mode\n\n---\n\n## Security Best Practices\n\n1. **Never commit secrets to version control**\n2. **Use different secrets for different environments**\n3. **Enable SSL/TLS in production (`DB_SSL=true`)**\n4. **Use strong, unique passwords for all services**\n5. **Enable monitoring and logging in production**\n6. **Regularly rotate secrets and API keys**\n7. **Use read-only mode for database management tools in production**\n8. **Keep JWT expiration times short in production**\n9. **Enable all security features for multi-tenant deployments**\n10. **Regularly review and update security configurations**"