# Story 30.10: Template Wizard Category Selection and Base Components

## Status

Draft

## Story

**As an** admin, **I want** a wizard to select template category with guided steps, **so that** I
can create templates faster.

## Acceptance Criteria

1. `TemplateWizardComponent` created with dialog
2. Wizard uses PrimeNG `p-steps`
3. `CategorySelectionComponent` created
4. `LivePreviewPanelComponent` created
5. Navigation logic implemented
6. Draft restoration
7. Advanced Mode toggle
8. Component tests

## Tasks / Subtasks

- [ ] **Task 1: Build `TemplateWizardComponent` shell** (AC: 1, 2, 5)
  - [ ] Create a standalone dialog component under
        `apps/web/src/app/features/admin/template-wizard/components` that wires PrimeNG `p-dialog` +
        `p-steps` for navigation.
        `[Source: docs/architecture/source-tree.md#frontend-structure-appsweb]`
  - [ ] Inject `TemplateWizardService` (Story 30.9) and expose signals for current step, validation
        state, and draft metadata using NgRx signals best practices.
        `[Source: docs/architecture/frontend-architecture.md#state-management-patterns]`

- [ ] **Task 2: Implement `CategorySelectionComponent`** (AC: 3, 5)
  - [ ] Render available categories with icons/badges (shared component) and call `setCategory` on
        selection; support keyboard navigation + ARIA labels to meet accessibility requirements.
        `[Source: docs/architecture/theme-system.md#key-design-principles]`

- [ ] **Task 3: Implement `LivePreviewPanelComponent`** (AC: 4)
  - [ ] Display generated schema preview (JSON + UI snapshot) by subscribing to service preview
        signals; ensure OnPush change detection and responsive layout for side-by-side viewing.
        `[Source: docs/architecture/frontend-architecture.md#component-template]`

- [ ] **Task 4: Add navigation + draft restoration logic** (AC: 5, 6)
  - [ ] Provide buttons for back/next/close, disabling next when validation fails; confirm drafts
        load on dialog open using service hydration.
        `[Source: docs/architecture/frontend-architecture.md#state-management-patterns]`

- [ ] **Task 5: Implement Advanced Mode toggle** (AC: 7)
  - [ ] Allow users to jump to the legacy JSON editor while preserving wizard state, following
        coding standards for environment-safe toggles.
        `[Source: docs/architecture/coding-standards.md#critical-fullstack-rules]`

- [ ] **Task 6: Component tests** (AC: 8)
  - [ ] Add Jest + Testing Library specs for wizard shell, category selection, and live preview
        verifying navigation, draft restoration, and toggle behavior.
        `[Source: docs/architecture/testing-strategy.md#frontend-component-test]`

## Dev Notes

### Previous Story Insights

- No specific guidance found in architecture docs.

### Data Models

- Wizard previews must align with `FormSchema` definitions that ultimately persist to the FORMS
  database, so the preview panel should display data derived from shared schema types.
  `[Source: docs/architecture/database-separation-implementation-summary.md#forms-database-nodeangularfullstack_forms]`

### API Specifications

- When the wizard saves templates it will hit authenticated template APIs that follow the REST
  specification (JWT, ApiError responses), so the UI should account for loading/error flows
  consistent with that contract.
  `[Source: docs/architecture/api-specification.md#rest-api-specification]`

### Component Specifications

- Standalone Angular components with OnPush change detection, PrimeNG dialogs/steps, and
  signal-based state are the expected patterns per the frontend architecture guidelines.
  `[Source: docs/architecture/frontend-architecture.md#component-template]`
- Accessibility (WCAG AA, ARIA, keyboard support) remains a first-class concern for interactive
  modals. `[Source: docs/architecture/theme-system.md#key-design-principles]`

### File Locations

- Wizard UI belongs in the admin/template wizard feature folder, while shared pieces like category
  badges stay in `apps/web/src/app/shared/components`, matching the documented source tree.
  `[Source: docs/architecture/source-tree.md#frontend-structure-appsweb]`

### Testing Requirements

- Jest + Testing Library component tests should live next to their components and exercise step
  transitions, service interactions, and error states.
  `[Source: docs/architecture/testing-strategy.md#frontend-component-test]`

### Technical Constraints

- Angular 20 + PrimeNG stack plus strict TypeScript typing and JSDoc are mandatory for all wizard
  classes. `[Source: docs/architecture/tech-stack.md#technology-stack-table]`
- Reuse shared services/types via `@nodeangularfullstack/shared` imports to avoid duplication.
  `[Source: docs/architecture/coding-standards.md#critical-fullstack-rules]`

## Testing

- Run component specs with
  `npm --workspace=apps/web run test -- --testPathPattern="template-wizard"` to validate dialog,
  category selection, and preview behaviors.
  `[Source: docs/architecture/testing-strategy.md#frontend-component-test]`
- Execute `npm run test` at root to ensure combined coverage before QA review.
  `[Source: docs/architecture/testing-strategy.md#frontend-tests]`

## Change Log

| Date       | Version | Description                          | Author             |
| ---------- | ------- | ------------------------------------ | ------------------ |
| 2025-01-27 | 1.0     | Initial story draft and task outline | Bob (Scrum Master) |

## Dev Agent Record

### Agent Model Used

_To be populated by the development agent._

### Debug Log References

_To be populated by the development agent._

### Completion Notes List

_To be populated by the development agent._

### File List

_To be populated by the development agent._

## QA Results

_QA review not yet executed for this draft._
