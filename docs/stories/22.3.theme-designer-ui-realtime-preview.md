# Story 22.3: Theme Designer User Interface and Real-Time Preview - Brownfield Addition

## User Story

As a system administrator, I want a visual theme designer interface with real-time preview, So that
I can create custom themes and see changes instantly before publishing them to the form builder.

## Story Context

**Existing System Integration:**

- Integrates with: Epic 20-21 ThemePreviewService, existing admin panel navigation, PrimeNG
  components
- Technology: Angular 20+ standalone components, PrimeNG 17+, Tailwind CSS, NgRx Signals
- Follows pattern: Existing admin components in `apps/web/src/app/features/admin/`
- Touch points: Admin routing, ThemePreviewService, existing admin layout components

## Acceptance Criteria

**Functional Requirements:**

1. Split-screen theme designer at `/admin/themes/designer` with controls (left panel) and live
   preview (right panel)
2. Field-type-aware styling controls for inputs, buttons, labels, textareas, selects, checkboxes,
   radios
3. Background customization options: solid colors, linear gradients, radial gradients, image upload
4. Real-time preview updates within 300ms of user input changes
5. Form sample preview includes all field types to validate theme application

**Integration Requirements:** 6. Theme designer integrates with existing admin navigation
breadcrumbs and menu structure 7. Preview accuracy matches actual form rendering using Epic 20-21
ThemePreviewService 8. Admin panel performance remains unchanged with theme designer active 9. Uses
existing PrimeNG components (ColorPicker, InputText, Dropdown, FileUpload) for consistency

**Quality Requirements:** 10. Component tests verify theme controls and preview synchronization 11.
Responsive design adapts to tablet and desktop viewports (mobile not required for admin) 12. Theme
validation prevents invalid configurations before saving

## Technical Notes

- **Integration Approach**: Extend existing admin module with new theme designer component
- **Existing Pattern Reference**: Follow `apps/web/src/app/features/admin/pages/` component
  structure
- **Key Constraints**: Real-time preview performance, ThemePreviewService CSS variable injection

## Definition of Done

- [ ] Theme designer component created with split-screen layout
- [ ] All field-type styling controls functional
- [ ] Real-time preview working with 300ms response time
- [ ] Integration with admin navigation completed
- [ ] Component tests verify functionality
- [ ] Responsive behavior on desktop and tablet confirmed

## Risk and Compatibility Check

**Minimal Risk Assessment:**

- **Primary Risk**: Real-time preview impacts admin panel performance
- **Mitigation**: Debounced preview updates, efficient CSS variable injection
- **Rollback**: Remove theme designer route and components

**Compatibility Verification:**

- [ ] No breaking changes to existing admin navigation or components
- [ ] ThemePreviewService remains unchanged from Epic 20-21
- [ ] Admin panel performance baseline maintained
- [ ] Existing admin UI patterns and styling preserved

## Files Modified

**New Files:**

- `apps/web/src/app/features/admin/pages/theme-designer/theme-designer.component.ts`
- `apps/web/src/app/features/admin/pages/theme-designer/theme-designer.component.html`
- `apps/web/src/app/features/admin/pages/theme-designer/theme-designer.component.scss`
- `apps/web/src/app/features/admin/components/theme-preview/theme-preview.component.ts`
- `apps/web/src/app/features/admin/services/theme-designer.service.ts`
- `apps/web/src/app/features/admin/pages/theme-designer/theme-designer.component.spec.ts`

**Modified Files:**

- `apps/web/src/app/features/admin/admin.routes.ts` (add theme designer route)
- `apps/web/src/app/features/admin/components/admin-nav/admin-nav.component.html` (add menu item)

**Integration Points:**

- Epic 20-21 ThemePreviewService: CSS variable injection for real-time preview
- Admin module: Navigation, routing, layout components
- PrimeNG components: ColorPicker, InputText, Dropdown, FileUpload, Panel

## UI Component Structure

```typescript
// Theme Designer Layout
┌─────────────────────────────────────────────────────────┐
│                    Admin Header                         │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────┐ │ ┌─────────────────────────────────┐ │
│ │ Theme Controls  │ │ │        Live Preview            │ │
│ │                 │ │ │                                │ │
│ │ • Basic Info    │ │ │  ┌─── Sample Form ────────┐   │ │
│ │ • Colors        │ │ │  │ [Text Input]           │   │ │
│ │ • Typography    │ │ │  │ [Select Dropdown]      │   │ │
│ │ • Backgrounds   │ │ │  │ [Textarea]             │   │ │
│ │ • Field Styles  │ │ │  │ [Checkbox] Option      │   │ │
│ │                 │ │ │  │ [Radio] Options        │   │ │
│ │ [Save Theme]    │ │ │  │ [Submit Button]        │   │ │
│ │ [Reset]         │ │ │  └────────────────────────┘   │ │
│ └─────────────────┘ │ └─────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

## Theme Controls Specification

**Basic Information:**

- Theme Name (required, unique validation)
- Description (optional)
- Category/Tags (optional)

**Color Controls:**

- Primary Color (hex picker)
- Secondary Color (hex picker)
- Text Colors (primary, secondary)
- Background Color (solid/gradient options)

**Typography Controls:**

- Heading Font (dropdown with Google Fonts)
- Body Font (dropdown with web-safe + Google Fonts)
- Font Sizes (heading, body, label)

**Background Controls:**

- Background Type: solid | linear-gradient | radial-gradient | image
- Gradient Controls: direction, color stops
- Image Upload: integration with existing file upload service
- Background Position/Size options

**Field-Specific Styles:**

- Input Border Style/Color/Radius
- Button Styles (primary, secondary)
- Label Formatting
- Checkbox/Radio Accent Colors

## Real-Time Preview Implementation

```typescript
// Debounced preview updates
private updatePreview = debounce((themeData: ThemeDefinition) => {
  this.themePreviewService.injectThemeVariables(themeData);
}, 300);

// Theme control change handler
onThemeControlChange(property: string, value: any) {
  this.currentTheme = { ...this.currentTheme, [property]: value };
  this.updatePreview(this.currentTheme);
}
```

---

**Story Owner**: Frontend Developer (Angular specialist) **Estimated Duration**: 8 hours
**Priority**: Depends on Story 22.2 completion (API endpoints) **Epic**: Epic 22 - Admin Theme
Designer
