# Sprint Plan: Epic 31.1 - CLI Package Foundation

**Generated by:** Quinn (Test Architect) **Date:** 2025-10-24 **Purpose:** Optimize velocity while
addressing technical debt from Story 31.1.2

---

## 📊 **Current State Analysis**

| Story  | Status   | Gate         | Quality Score | Blocker?                 |
| ------ | -------- | ------------ | ------------- | ------------------------ |
| 31.1.1 | Done     | Not reviewed | N/A           | No                       |
| 31.1.2 | Done     | **CONCERNS** | **60/100**    | No (functional complete) |
| 31.1.3 | Ready    | Not started  | N/A           | No                       |
| 31.1.4 | Approved | Not started  | N/A           | No                       |

**Key Finding:** Story 31.1.2 has CONCERNS gate (missing tests) but is **not blocking** 31.1.3.

---

## 🎯 **Strategic Approach: Parallel Streams**

Instead of blocking progress, run **two parallel work streams**:

```
┌─────────────────────────────────────────────────────────────┐
│                     EPIC 31.1 SPRINT PLAN                    │
└─────────────────────────────────────────────────────────────┘

Week 1: Parallel Development
═══════════════════════════════

Stream A (Feature Track)          Stream B (Quality Track)
┌─────────────────────┐          ┌─────────────────────┐
│  Story 31.1.3       │          │  Story 31.1.4       │
│  EJS Template       │          │  Unit Testing       │
│  System             │          │  Framework          │
│                     │          │                     │
│  Status: Ready      │          │  Priority: HIGH     │
│  Estimate: 6-8 hrs  │          │  Estimate: 4-6 hrs  │
│  Risk: Low          │          │  Risk: Low          │
│  Blocks: 31.2.1     │          │  Resolves: 31.1.2   │
└─────────────────────┘          └─────────────────────┘
        ↓                                  ↓
   Continues                        Addresses
   Feature                          Tech Debt
   Development

Week 2: Integration & QA
═══════════════════════

Stream A: QA Review 31.1.3       Stream B: Merge & Verify
┌─────────────────────┐          ┌─────────────────────┐
│  Quinn reviews      │          │  Tests pass         │
│  31.1.3 for gate    │   →      │  Coverage ≥80%      │
│  decision           │          │  31.1.2 gate → PASS │
└─────────────────────┘          └─────────────────────┘
                                           ↓
                                    Epic 31.1 Complete
                                    (All stories PASS)
```

---

## 📅 **Detailed Sprint Schedule**

### **Day 1-2: Kickoff (Parallel Start)**

**Stream A - Story 31.1.3 (EJS Templates):**

- [ ] Create EJS template files (component, service, controller, repository, types)
- [ ] Implement template loader module
- [ ] Add template rendering utilities
- [ ] Manual testing with sample data

**Stream B - Story 31.1.4 (Unit Tests):**

- [ ] Install Jest + ts-jest dependencies
- [ ] Create jest.config.js
- [ ] Create test directory structure
- [ ] Write tests for toKebabCase (with QA edge cases)

**Status Check:** Both streams should be ~40% complete by end of Day 2.

---

### **Day 3-4: Development (Parallel Continue)**

**Stream A - Story 31.1.3 (continued):**

- [ ] Add name conversion utilities (toPascalCase, toCamelCase, toSnakeCase)
- [ ] Integrate template system with CLI
- [ ] Test template generation end-to-end
- [ ] Update documentation

**Stream B - Story 31.1.4 (continued):**

- [ ] Write tests for validateToolId (with QA edge cases + security)
- [ ] Write tests for validateToolName (with QA boundary tests)
- [ ] Write tests for generateDefaultId
- [ ] Run coverage report (verify ≥80%, target 95%+ for string-helpers)

**Status Check:** Stream A ~80% complete, Stream B ~80% complete.

---

### **Day 5: Completion & Handoff**

**Stream A - Story 31.1.3:**

- [ ] Final testing and bug fixes
- [ ] Mark story as "Ready for Review"
- [ ] Handoff to Quinn for QA review

**Stream B - Story 31.1.4:**

- [ ] Add template rendering tests (if templates exist from 31.1.3)
- [ ] Final coverage verification
- [ ] Mark story as "Done"
- [ ] Update 31.1.2 gate status from CONCERNS → PASS

**Outcome:**

- 31.1.3 enters QA queue
- 31.1.4 complete (technical debt resolved)
- 31.1.2 gate upgraded to PASS

---

### **Day 6-7: QA Review & Integration**

**Quinn's Activities:**

- [ ] Comprehensive review of Story 31.1.3 (using lessons from 31.1.2)
- [ ] Check template edge cases (malformed data, missing variables)
- [ ] Verify integration with string-helpers utilities
- [ ] Create gate file for 31.1.3
- [ ] Update story with QA Results

**Dev Activities (if needed):**

- [ ] Address any QA findings from 31.1.3 review
- [ ] Re-run tests after fixes
- [ ] Final verification

**Outcome:**

- 31.1.3 gate decision (PASS/CONCERNS/FAIL)
- Epic 31.1 status assessment
- Decision on Epic 31.2 readiness

---

## 🎯 **Success Criteria**

### **Epic 31.1 Complete When:**

✅ **Story 31.1.1:** Done (CLI package setup) ✅ **Story 31.1.2:** Done with PASS gate (tests added
via 31.1.4) ✅ **Story 31.1.3:** Done with PASS gate (templates working) ✅ **Story 31.1.4:** Done
(test coverage ≥80%)

### **Quality Gates:**

- All stories have gate files in `docs/qa/gates/`
- All gates are PASS (or explicitly WAIVED with approval)
- Test coverage ≥80% for CLI package
- Zero HIGH or CRITICAL unresolved issues

### **Technical Debt:**

- 31.1.2 CONCERNS resolved (tests added)
- No new debt introduced in 31.1.3
- Foundation solid for Epic 31.2

---

## ⚡ **Resource Allocation**

### **Recommended Team Assignment:**

**If 1 Developer:**

```
Option A (Sequential):
Day 1-3: Story 31.1.4 (tests) → Resolves debt
Day 4-6: Story 31.1.3 (templates) → Feature progress
Day 7: QA review & integration

Option B (Interleaved):
Day 1: 31.1.4 setup + 31.1.3 planning
Day 2: 31.1.4 tests (3 hrs) + 31.1.3 templates (3 hrs)
Day 3: 31.1.4 tests (3 hrs) + 31.1.3 templates (3 hrs)
Day 4-5: 31.1.3 completion + 31.1.4 template tests
Day 6-7: QA review & fixes
```

**If 2+ Developers:**

```
Dev A: Focus on Story 31.1.4 (Quality Track)
Dev B: Focus on Story 31.1.3 (Feature Track)
Quinn: QA reviews on Day 6-7

Benefit: True parallel development, faster completion
```

---

## 🚧 **Risks & Mitigation**

### **Risk 1: Template tests depend on templates existing**

**Impact:** Story 31.1.4 Task 7 (template rendering tests) blocked until 31.1.3 done.

**Mitigation:**

- ✅ Start 31.1.4 with utility tests (Tasks 5-6) - no dependencies
- ✅ Add template tests (Task 7) after 31.1.3 templates exist
- ✅ This is why Task 7 is scheduled for Day 4-5 (after 31.1.3 templates ready)

**Timeline Impact:** None if parallel streams coordinated correctly.

---

### **Risk 2: QA review finds major issues in 31.1.3**

**Impact:** Rework needed, delays Epic 31.1 completion.

**Mitigation:**

- ✅ Apply lessons learned from 31.1.2 review proactively
- ✅ Dev self-reviews against 31.1.2 gate criteria before handoff
- ✅ Check edge cases during development (not just happy path)
- ✅ Ensure tests exist for 31.1.3 utilities (prevent repeat of 31.1.2)

**Probability:** Low (if dev uses 31.1.2 insights)

---

### **Risk 3: Coverage doesn't reach 80% threshold**

**Impact:** Story 31.1.4 acceptance criteria not met.

**Mitigation:**

- ✅ Use coverage report to identify gaps: `npm test:coverage`
- ✅ Focus on branches (if/else) and error paths (catch blocks)
- ✅ QA provided specific edge cases to test (see 31.1.4 Dev Notes)
- ✅ String utilities are pure functions (easy to reach 95%+ coverage)

**Probability:** Very Low (pure functions are easy to test)

---

## 📈 **Velocity Metrics**

### **Baseline (Sequential Approach):**

```
Week 1: Story 31.1.4 (4-6 hrs)
Week 2: Story 31.1.3 (6-8 hrs)
Week 3: QA reviews + fixes

Total: 3 weeks for 2 stories
```

### **Optimized (Parallel Approach):**

```
Week 1: Stories 31.1.4 + 31.1.3 (parallel)
Week 2: QA reviews + integration

Total: 2 weeks for 2 stories (33% faster)
```

**Velocity Gain:** +33% throughput by parallelizing independent work streams.

---

## 🎓 **Key Insights**

### **From 31.1.2 QA Review:**

1. **Code First, Tests Later = Technical Debt**
   - 31.1.2 shipped with 0% test coverage
   - Resulted in CONCERNS gate (60/100 quality score)
   - Creating 31.1.4 to backfill tests

2. **Pure Functions Are Easy to Test**
   - String utilities: toKebabCase, validateToolId, etc.
   - No mocks/stubs needed (deterministic outputs)
   - Target 95%+ coverage (not just 80%)

3. **Edge Cases Matter**
   - QA identified: boundary tests (2 chars, 50 chars)
   - Security tests (SQL injection, path traversal)
   - These weren't in original 31.1.4 plan - QA added them

4. **Shift-Left Testing Saves Time**
   - Testing 31.1.2 _after_ coding: Found 0/100 test coverage
   - Testing 31.1.3 _during_ coding: Can reach 80%+ on first pass
   - Lesson: Write tests alongside code, not after

---

## ✅ **Next Actions**

### **Immediate (Today):**

- [x] Phase 1: Update Story 31.1.4 with QA insights ✓ COMPLETE
- [x] Phase 2: Create sprint plan ✓ COMPLETE
- [ ] Phase 3: Review Story 31.1.3 proactively (Quinn)

### **This Week:**

- [ ] Assign Story 31.1.4 to dev (HIGH priority)
- [ ] Assign Story 31.1.3 to dev (can run parallel)
- [ ] Schedule daily standup to sync parallel streams

### **Next Week:**

- [ ] QA review of 31.1.3 (Quinn)
- [ ] Verify 31.1.2 gate updated to PASS
- [ ] Epic 31.1 completion celebration 🎉
- [ ] Plan Epic 31.2 kickoff

---

## 📚 **References**

- **Story 31.1.2:** `docs/stories/31/31.1.2.interactive-prompts-inquirer.md`
- **31.1.2 Gate:** `docs/qa/gates/31.1.2-interactive-prompts-inquirer.yml` (CONCERNS)
- **Story 31.1.3:** `docs/stories/31/31.1.3.ejs-template-system.md`
- **Story 31.1.4:** `docs/stories/31/31.1.4.cli-unit-testing-framework.md` (UPDATED with QA
  insights)

---

**Sprint Plan Status:** ✅ APPROVED **Recommended Start Date:** Immediately **Expected Completion:**
2 weeks (with parallel streams)

_This sprint plan optimizes for velocity while maintaining quality. Technical debt from 31.1.2 is
addressed systematically without blocking feature development._
